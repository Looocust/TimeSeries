[["en-busca-de-los-datos.html", "Capítulo 3 En busca de los datos", " Capítulo 3 En busca de los datos # Instalar una sola vez si no los tienes # install.packages(c(&quot;tidyverse&quot;, &quot;readxl&quot;, &quot;lubridate&quot;, &quot;zoo&quot;, &quot;forecast&quot;)) library(tidyverse) # dplyr, ggplot2, etc. library(readxl) # leer archivos .xlsx library(lubridate) # manejo de fechas library(zoo) # promedios móviles library(forecast) # funciones de series de tiempo # Leer la primera hoja (cámbiala con `sheet =` si hiciera falta) retail &lt;- read_excel(&quot;Online Retail 2.xlsx&quot;) # Vistazo rápido a la estructura dplyr::glimpse(retail) ## Rows: 541,909 ## Columns: 8 ## $ InvoiceNo &lt;chr&gt; &quot;536365&quot;, &quot;536365&quot;, &quot;536365&quot;, &quot;536365&quot;, &quot;536365&quot;, &quot;536365&quot;… ## $ StockCode &lt;chr&gt; &quot;85123A&quot;, &quot;71053&quot;, &quot;84406B&quot;, &quot;84029G&quot;, &quot;84029E&quot;, &quot;22752&quot;, … ## $ Description &lt;chr&gt; &quot;WHITE HANGING HEART T-LIGHT HOLDER&quot;, &quot;WHITE METAL LANTERN… ## $ Quantity &lt;dbl&gt; 6, 6, 8, 6, 6, 2, 6, 6, 6, 32, 6, 6, 8, 6, 6, 3, 2, 3, 3, … ## $ InvoiceDate &lt;dttm&gt; 2010-12-01 08:26:00, 2010-12-01 08:26:00, 2010-12-01 08:2… ## $ UnitPrice &lt;dbl&gt; 2.55, 3.39, 2.75, 3.39, 3.39, 7.65, 4.25, 1.85, 1.85, 1.69… ## $ CustomerID &lt;dbl&gt; 17850, 17850, 17850, 17850, 17850, 17850, 17850, 17850, 17… ## $ Country &lt;chr&gt; &quot;United Kingdom&quot;, &quot;United Kingdom&quot;, &quot;United Kingdom&quot;, &quot;Uni… ## --- 1. Agregar la cantidad por día ---------------------------------- # Aseguramos que &#39;InvoiceDate&#39; sea fecha-hora y creamos la columna Date retail &lt;- retail %&gt;% mutate(Date = as.Date(InvoiceDate)) # Sumamos la cantidad vendida por día daily_sales &lt;- retail %&gt;% group_by(Date) %&gt;% summarise(TotalQty = sum(Quantity, na.rm = TRUE)) %&gt;% ungroup() ## --- 2. Gráfico base de la serie diaria ------------------------------ library(ggplot2) ggplot(daily_sales, aes(Date, TotalQty)) + geom_line(color = &quot;gray40&quot;) + labs(title = &quot;Cantidad total vendida por día&quot;, x = &quot;Fecha&quot;, y = &quot;Total de unidades&quot;) + theme_minimal() library(dplyr) library(zoo) # Crear tabla con medias móviles daily_ma &lt;- daily_sales %&gt;% arrange(Date) %&gt;% mutate( MA_7 = zoo::rollmeanr(TotalQty, 7, fill = NA), MA_30 = zoo::rollmeanr(TotalQty, 30, fill = NA) ) names(daily_ma) ## [1] &quot;Date&quot; &quot;TotalQty&quot; &quot;MA_7&quot; &quot;MA_30&quot; library(ggplot2) ggplot(daily_ma, aes(Date)) + geom_line(aes(y = TotalQty), colour = &quot;grey70&quot;) + geom_line(aes(y = MA_7), colour = &quot;blue&quot;) + geom_line(aes(y = MA_30), colour = &quot;red&quot;) + labs(title = &quot;Promedios móviles de 7 y 30 días&quot;, y = &quot;Total de unidades&quot;) + theme_minimal() ## Warning: Removed 6 rows containing missing values or values outside the scale range ## (`geom_line()`). ## Warning: Removed 29 rows containing missing values or values outside the scale range ## (`geom_line()`). La media móvil de 30 días (línea roja) muestra una tendencia ascendente clara desde mayo-2011, mientras que la de 7 días (azul) revela picos semanales. library(dplyr) library(ggplot2) daily_lag &lt;- daily_sales %&gt;% # usamos la tabla diaria original arrange(Date) %&gt;% mutate( Lag_1 = dplyr::lag(TotalQty, 1), Lag_7 = dplyr::lag(TotalQty, 7) ) ggplot(daily_lag, aes(Date)) + geom_line(aes(y = TotalQty), colour = &quot;black&quot;) + geom_line(aes(y = Lag_1), colour = &quot;orange&quot;, linetype = &quot;dashed&quot;) + geom_line(aes(y = Lag_7), colour = &quot;purple&quot;, linetype = &quot;dotted&quot;) + labs(title = &quot;Serie comparada con rezagos de 1 y 7 días&quot;, y = &quot;Total de unidades&quot;) + theme_minimal() ## Warning: Removed 1 row containing missing values or values outside the scale range ## (`geom_line()`). ## Warning: Removed 7 rows containing missing values or values outside the scale range ## (`geom_line()`). La superposición con el rezago de 1 día (naranja) indica alta autocorrelación diaria; el rezago-7 (morado) refuerza la periodicidad semanal. library(forecast) # ya lo tienes cargado library(ggplot2) # 1. Convertir la columna TotalQty en un objeto ts semanal ts_qty &lt;- ts(daily_sales$TotalQty, frequency = 7) # 2. Descomponer con STL decomp &lt;- stl(ts_qty, s.window = &quot;periodic&quot;) # 3. Graficar los componentes autoplot(decomp) + labs(title = &quot;Descomposición STL: tendencia, estacionalidad y residuales&quot;) El componente seasonal presenta oscilaciones regulares cada 7 puntos, confirmando efecto semanal; la tendencia suavizada muestra un crecimiento paulatino en la demanda. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
